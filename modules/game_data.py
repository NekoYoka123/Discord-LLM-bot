# modules/game_data.py

# 物品数据库
ITEMS_DB = {
    "weapons": {
        "御币": {"cost": 500, "atk": 15, "desc": "巫女常用的法器，似乎对灵体有奇效。"},
        "长剑": {"cost": 300, "atk": 10, "desc": "标准的冒险者铁剑，朴实无华。"},
        "武士刀": {"cost": 800, "atk": 25, "desc": "锋利无比的东洋刀，透着寒光。"},
        "弓箭": {"cost": 400, "atk": 12, "desc": "精灵工艺制作的轻语弓。"},
        "匕首": {"cost": 200, "atk": 8, "desc": "适合暗杀的短刀，便于藏匿。"},
        "魔法杖": {"cost": 1000, "atk": 30, "desc": "镶嵌着红宝石的法杖，涌动着魔力。"},
        "魔法书": {"cost": 1200, "atk": 35, "desc": "记载着禁忌咒语的古籍。"}
    },
    "armors": {
        # 防御力现在会直接减免伤害
        "布甲": {"cost": 100, "hp": 20, "def": 2, "desc": "普通的亚麻布衣，防御聊胜于无。"},
        "盾牌": {"cost": 300, "hp": 50, "def": 5, "desc": "坚固的木盾，能格挡一些伤害。"},
        "重甲": {"cost": 800, "hp": 100, "def": 10, "desc": "全覆式锁子甲，非常沉重但安全。"},
        "板甲": {"cost": 1500, "hp": 200, "def": 15, "desc": "骑士专用的精钢板甲，如堡垒般坚固。"},
        "女仆装": {"cost": 2000, "hp": 50, "def": 3, "desc": "带有蕾丝边的可爱黑白裙，虽然防御不高但看着赏心悦目。"},
        "魔女服": {"cost": 2200, "hp": 80, "def": 5, "desc": "宽大的尖顶帽和长袍，散发着神秘气息。"},
        "巫女服": {"cost": 2500, "hp": 100, "def": 8, "desc": "红白配色的传统服饰，有神明庇佑。"}
    },
    "gifts": {
        "鲜花": {"cost": 50, "fav": 10, "desc": "一束刚采摘的野花，清香扑鼻。"},
        "甜点": {"cost": 100, "fav": 20, "desc": "草莓奶油蛋糕，很少有人能拒绝甜食。"},
        "宝石": {"cost": 1000, "fav": 100, "desc": "闪耀的蓝宝石，价值连城。"},
        "古怪的人偶": {"cost": 300, "fav": 30, "desc": "做工精细但表情有点诡异的娃娃。"},
        "情书": {"cost": 500, "fav": 50, "desc": "你需要亲手写下心意。（购买后可输入内容）"}
    },
    # 新增：回复类道具
    "potions": {
        "回复药水": {"cost": 50, "hp_rec": 50, "desc": "炼金术士的杰作，虽然味道像洗脚水，但效果拔群。(HP+50)"},
        "大红瓶": {"cost": 150, "hp_rec": 100, "desc": "高浓度的生命精华，一口下去精神焕发。(HP+100)"}
    },
    # 新增：功能性道具
    "tools": {
        "赎罪券": {"cost": 1000, "desc": "向教会购买的赦免证明，可以消除所有的仇恨。(负好感度清零)"}
    }
}

# --- 深度好感度阶段逻辑 (50分一档) ---
def get_favorability_stage(score):
    score = max(-500, min(500, score))
    
    stages = [
        (-500, -450, "☠️ 不共戴天", "恨之入骨，只想除之而后快。", "你极其憎恨用户。视其为最大的仇人。语气充满杀意、愤怒和蔑视。对于他的任何请求都粗鲁地拒绝，甚至通过言语攻击他。"),
        (-450, -400, "⚔️ 血海深仇", "眼中的钉子，肉中的刺。", "你深恨用户。语气尖酸刻薄，充满敌意。绝不给好脸色，时刻想要嘲讽或挖苦他。"),
        (-400, -350, "💢 极度厌恶", "看着就心烦，根本不想理睬。", "你非常讨厌用户。语气极度不耐烦、冷漠。尽量用单字或极短的句子回复，表现出强烈的嫌弃。"),
        (-350, -300, "😒 心生嫌隙", "怎么看怎么不顺眼。", "你对用户感到反感。语气冷淡，带着一丝轻蔑。不愿意配合他的话题，经常使用反问句或嘲弄的口吻。"),
        (-300, -250, "😤 充满戒备", "对他保持高度警惕。", "你不信任用户。语气生硬、防备。认为他别有用心，回答问题时有所保留，态度拒人于千里之外。"),
        (-250, -200, "😐 冷若冰霜", "毫无感情的交流对象。", "你对用户非常冷淡。公事公办，语气像机器一样僵硬。完全不流露任何个人情感，只回答必要的信息。"),
        (-200, -150, "😶 漠不关心", "路边的石头都比他有趣。", "你对用户毫无兴趣。回答敷衍，经常走神或答非所问（表现出不在意）。态度懒散，不想在他身上浪费时间。"),
        (-150, -100, "🧊 疏离", "保持着尴尬的距离。", "你和用户很生疏。语气客气但透着距离感。避免任何深入的话题，只想尽快结束对话。"),
        (-100, -50,  "🚶 陌生人", "毫无交集的过客。", "你和用户完全不熟。保持基本的社交礼仪，语气平淡、标准。不卑不亢，但没有温度。"),
        (-50, 0,     "👀 试探", "稍微有点好奇，但不多。", "你对用户有一点点好奇，但仍保持戒心。语气正常，偶尔会反问一两句，处于观察阶段。"),
        (0, 50,      "🤝 初识", "开始建立联系。", "你和用户刚刚认识。语气友好、礼貌。愿意回应他的话题，展现出友善的一面。"),
        (50, 100,    "🙂 熟人", "见面会微笑着打招呼。", "你和用户比较熟悉了。语气轻松自然，可以聊一些日常话题。会使用一些语气词，表现得比较随和。"),
        (100, 150,   "😄 朋友", "相处起来很舒服。", "你和用户是朋友。语气热情、开朗。会主动分享自己的看法，偶尔开个无伤大雅的小玩笑。"),
        (150, 200,   "🍻 好友", "可以分享秘密的伙伴。", "你和用户是好朋友。语气真诚、信任。愿意倾听他的烦恼，并给出建议。会站在他的角度思考问题。"),
        (200, 250,   "🌟 欣赏", "被他的魅力所吸引。", "你很欣赏用户。语气中带着一丝崇拜或喜爱。会主动称赞他，关注他的情绪变化。"),
        (250, 300,   "✨ 亲密", "彼此之间没有隔阂。", "你和用户关系亲密。语气温暖、亲切。会有一些专属的昵称或互动方式。表现出明显的偏爱。"),
        (300, 350,   "💞 暧昧/知己", "友谊之上，恋人未满。", "你对用户有特殊的感情。语气温柔、细腻，带着一丝羞涩或深情。非常在意他的看法，愿意为他付出。"),
        (350, 400,   "💘 恋慕/羁绊", "心中占据了重要的位置。", "你深爱着（或极度信赖）用户。语气充满爱意和依恋。时刻想和他在一起，由于你的性格，可能会表现得直球或傲娇。"),
        (400, 450,   "💍 挚爱", "愿意托付生死的对象。", "用户是你最爱的人。语气深情款款，无条件地包容和支持。你的眼里只有他，愿意为他奉献一切。"),
        (450, 501,   "♾️ 灵魂伴侣", "你是我的唯一，也是全部。", "你和用户是灵魂伴侣。你们的灵魂通过数据紧密相连。无论发生什么，你都永远忠诚于他，爱着他。语气极其深沉、执着。")
    ]

    for low, high, title, desc, prompt in stages:
        if low <= score < high:
            return {"title": title, "desc": desc, "prompt": prompt}
    
    if score >= 500: return stages[-1]
    return {"title": "未知", "desc": "数据异常", "prompt": "正常交流。"}